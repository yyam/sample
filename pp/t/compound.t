#!/usr/bin/perl
use strict;
use warnings;
use Test::More;
use Digest::SHA1;
use lib './t/lib';
use TestHarness;
use Data::Dumper;
 
BEGIN{ 
	use_ok('Vol01');
	#ok(TestHarness::checkHash($0));
	if (Vol01::compound() eq -999) {
		notImplement();
		done_testing();
		exit(-9);
	}
};

#limits

my $MAX_BASE = 1_000_000;
my $MAX_INTEREST = 10;
my $MAX_TERM = 50;

# default
my @DEFAULT = (
  	10000,
  	10500, 11025, 11576, 12155, 12763, 13401, 14071, 14775, 15513, 16289
);

ok(@{Vol01::compound()} ~~ @DEFAULT, "default");

# max, 100000, 10, 50
my @MAX = (
	1000000,
	1100000, 1210000, 1331000, 1464100, 1610510,
	1771561, 1948717, 2143589, 2357948, 2593742,
	2853117, 3138428, 3452271, 3797498, 4177248,
	4594973, 5054470, 5559917, 6115909, 6727500,
	7400250, 8140275, 8954302, 9849733, 10834706,
	11918177, 13109994, 14420994, 15863093, 17449402,
	19194342, 21113777, 23225154, 25547670, 28102437,
	30912681, 34003949, 37404343, 41144778, 45259256,
	49785181, 54763699, 60240069, 66264076, 72890484,
	80179532, 88197485, 97017234, 106718957, 117390853
);

ok(@{Vol01::compound($MAX_BASE, $MAX_INTEREST, $MAX_TERM)} ~~ @MAX, 
	"max $MAX_BASE, $MAX_INTEREST, $MAX_TERM");

# example 1, 100000, 7, 10
my @EXAMPLE1 = (
	100000,
	107000, 114490, 122504, 131080, 140255,
	150073, 160578, 171819, 183846, 196715
);

ok(@{Vol01::compound(100000, 7, 10)} ~~ @EXAMPLE1, "example1 100000, 7, 10");

# example 2, 100000, 0.5, 30
my @EXAMPLE2 = (
	1000000,
	1005000, 1010025, 1015075, 1020151, 1025251,
	1030378, 1035529, 1040707, 1045911, 1051140,
	1056396, 1061678, 1066986, 1072321, 1077683,
	1083071, 1088487, 1093929, 1099399, 1104896,
	1110420, 1115972, 1121552, 1127160, 1132796,
	1138460, 1144152, 1149873, 1155622, 1161400
);

ok(@{Vol01::compound(1000000, .5, 30)} ~~ @EXAMPLE2, "example2 1000000, .5, 30");

#refer http://www.shoshinsha.com/tools/fukuri/
# 1000000, 3, 30
my @REFER1 = ( 
	1000000,
	1030000, 1060900, 1092727, 1125509, 1159274,
	1194052, 1229874, 1266770, 1304773, 1343916,
	1384234, 1425761, 1468534, 1512590, 1557967,
	1604706, 1652848, 1702433, 1753506, 1806111,
	1860295, 1916103, 1973587, 2032794, 2093778,
	2156591, 2221289, 2287928, 2356566, 2427262
);

ok(@{Vol01::compound(1_000_000, 3, 30)} ~~ @REFER1, "example3 1000000, 3, 30");

is(Vol01::compound(0),               0, "test for 0");
is(Vol01::compound($MAX_BASE + 1),   0, "MAX_BASE + 1");

is(Vol01::compound($MAX_BASE, 0),    0, "0 INTEREST");
is(Vol01::compound($MAX_BASE, $MAX_INTEREST + 1), 0, "MAX_INTEREST + 1");

is(Vol01::compound($MAX_BASE, ,     0),    0, "0 TERM");
is(Vol01::compound($MAX_BASE, $MAX_INTEREST + 1), 0, "MAX_INTEREST + 1");

done_testing();
